# ๐ Athar Backend API

## ๐ ูุธุฑุฉ ุนุงูุฉ

Backend API ูููุตุฉ ุฃุซุฑ - ููุตุฉ ููุดุงุฑูุฉ ุงูุฃููุงุฑ ูุงููุญุชูู.

---

## ๐๏ธ ุงูุชูููุงุช ุงููุณุชุฎุฏูุฉ

- **Node.js** + **Express.js**
- **MySQL** (ูุงุนุฏุฉ ุงูุจูุงูุงุช)
- **JWT** (ุงููุตุงุฏูุฉ)
- **OTP.dev** (ุงูุชุญูู ุนุจุฑ WhatsApp)
- **AWS S3** (ุชุฎุฒูู ุงููููุงุช)

---

## ๐ฆ ุงูุชุซุจูุช

```bash
# 1. ุชุซุจูุช Dependencies
npm install

# 2. ุฅุนุฏุงุฏ ููู .env
cp .env.example .env
# ุซู ูู ุจุชุนุฏูู ุงูููู ูู .env

# 3. ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช
npm run init-db

# 4. (ุงุฎุชูุงุฑู) ุฅุถุงูุฉ ุจูุงูุงุช ุชุฌุฑูุจูุฉ
npm run seed

# 5. ุชุดุบูู ุงูุณูุฑูุฑ
npm start
```

---

## ๐๏ธ ุจููุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช

### **ุฌุฏุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:**

#### 1. **users**
- `id` - ูุนุฑู ุงููุณุชุฎุฏู
- `phone` - ุฑูู ุงููุงุชู (ูุฑูุฏ)
- `name` - ุงูุงุณู
- `email` - ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- `password` - ูููุฉ ุงููุฑูุฑ (ูุดูุฑุฉ)
- `bio` - ูุจุฐุฉ ุนู ุงููุณุชุฎุฏู
- `profile_image` - ุตูุฑุฉ ุงูููู ุงูุดุฎุตู
- `push_token` - ุฑูุฒ ุงูุฅุดุนุงุฑุงุช
- `is_verified` - ุญุงูุฉ ุงูุชุญูู
- `is_banned` - ุญุงูุฉ ุงูุญุธุฑ
- `ban_reason` - ุณุจุจ ุงูุญุธุฑ
- `role` - ุงูุฏูุฑ (user/admin)

#### 2. **boxes** โจ **ุฌุฏูุฏ**
- `id` - ูุนุฑู ุงูุตูุฏูู
- `name` - ุงุณู ุงูุตูุฏูู
- `description` - ูุตู ุงูุตูุฏูู
- `icon` - ุฃููููุฉ ุงูุตูุฏูู
- `image_url` - ุฑุงุจุท ุตูุฑุฉ ุงูุตูุฏูู
- `color` - ููู ุงูุตูุฏูู
- `is_active` - ุญุงูุฉ ุงูุชูุนูู
- `order_index` - ุชุฑุชูุจ ุงูุนุฑุถ

#### 3. **categories** โจ **ุฌุฏูุฏ**
- `id` - ูุนุฑู ุงููุฆุฉ
- `name` - ุงุณู ุงููุฆุฉ
- `description` - ูุตู ุงููุฆุฉ
- `icon` - ุฃููููุฉ ุงููุฆุฉ
- `color` - ููู ุงููุฆุฉ
- `box_id` - ูุนุฑู ุงูุตูุฏูู ุงููุฑุชุจุท
- `is_active` - ุญุงูุฉ ุงูุชูุนูู
- `order_index` - ุชุฑุชูุจ ุงูุนุฑุถ

#### 4. **posts**
- `id` - ูุนุฑู ุงูููุดูุฑ
- `user_id` - ูุนุฑู ุงููุณุชุฎุฏู
- `type` - ููุน ุงูููุดูุฑ (text/image/video/link)
- `title` - ุงูุนููุงู
- `content` - ุงููุญุชูู
- `media_url` - ุฑุงุจุท ุงููุณุงุฆุท
- `link_url` - ุฑุงุจุท ุฎุงุฑุฌู
- `category` - ุงูุชุตููู
- `is_archived` - ุญุงูุฉ ุงูุฃุฑุดูุฉ
- `is_private` - ููุดูุฑ ุฎุงุต/ุนุงู
- `is_featured` - ููุดูุฑ ูููุฒ
- `views_count` - ุนุฏุฏ ุงููุดุงูุฏุงุช

#### 5. **comments**
- `id` - ูุนุฑู ุงูุชุนููู
- `post_id` - ูุนุฑู ุงูููุดูุฑ
- `user_id` - ูุนุฑู ุงููุณุชุฎุฏู
- `content` - ุงููุญุชูู
- `parent_id` - ูุนุฑู ุงูุชุนููู ุงูุฃุจ (ููุฑุฏูุฏ)

#### 6. **likes**
- `id` - ูุนุฑู ุงูุฅุนุฌุงุจ
- `post_id` - ูุนุฑู ุงูููุดูุฑ
- `user_id` - ูุนุฑู ุงููุณุชุฎุฏู

#### 7. **favorites**
- `id` - ูุนุฑู ุงูููุถูุฉ
- `post_id` - ูุนุฑู ุงูููุดูุฑ
- `user_id` - ูุนุฑู ุงููุณุชุฎุฏู

#### 8. **follows**
- `id` - ูุนุฑู ุงููุชุงุจุนุฉ
- `follower_id` - ูุนุฑู ุงููุชุงุจูุน
- `followed_id` - ูุนุฑู ุงููุชุงุจูุน

#### 9. **notifications**
- `id` - ูุนุฑู ุงูุฅุดุนุงุฑ
- `user_id` - ูุนุฑู ุงููุณุชุฎุฏู
- `type` - ููุน ุงูุฅุดุนุงุฑ (like/comment/follow/mention/admin)
- `title` - ุนููุงู ุงูุฅุดุนุงุฑ
- `body` - ูุญุชูู ุงูุฅุดุนุงุฑ
- `data` - ุจูุงูุงุช ุฅุถุงููุฉ (JSON)
- `is_read` - ุญุงูุฉ ุงููุฑุงุกุฉ

---

## ๐ง Scripts ุงููุชุงุญุฉ

```bash
# ุชุดุบูู ุงูุณูุฑูุฑ
npm start

# ุชุดุบูู ุงูุณูุฑูุฑ ูุน ุงูุชุญุฏูุซ ุงูุชููุงุฆู (Development)
npm run dev

# ุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช (ูุดูู ุฌููุน ุงูุฌุฏุงูู ูุงูุจูุงูุงุช ุงูุงูุชุฑุงุถูุฉ)
npm run init-db

# ุฅุถุงูุฉ ุจูุงูุงุช ุชุฌุฑูุจูุฉ
npm run seed

# ุฅูุดุงุก ูุณุชุฎุฏู ุชุฌุฑูุจู
npm run create-test-user
```

---

## ๐ ููุงุญุธุงุช ูููุฉ

### โ **ูุง ุชูุฌุฏ ูููุงุช Migration ูููุตูุฉ**
- ุฌููุน ุงูุฌุฏุงูู ูุงูุญููู ููุฌูุฏุฉ ูู `initDatabase.js`
- ูุง ุญุงุฌุฉ ูุชุดุบูู migrations ูููุตูุฉ
- ููุท ูู ุจุชุดุบูู `npm run init-db` ูุฅูุดุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงููุฉ

### โ **ุงูุจูุงูุงุช ุงูุงูุชุฑุงุถูุฉ ุงููุถุงูุฉ ุชููุงุฆูุงู:**
1. **6 ุตูุงุฏูู (Boxes):**
   - ุตูุฏูู ุงูุชูููุฉ ูุงูุจุฑูุฌุฉ
   - ุตูุฏูู ุงููู ูุงูุฅุจุฏุงุน
   - ุตูุฏูู ุงููุชุงุจุฉ ูุงูุฃุฏุจ
   - ุตูุฏูู ุงูุฑูุงุถุฉ ูุงูููุงูุฉ
   - ุตูุฏูู ุงูุณูุฑ ูุงููุบุงูุฑุงุช
   - ุตูุฏูู ุฑูุงุฏุฉ ุงูุฃุนูุงู

2. **18 ูุฆุฉ (Categories):**
   - ุจุฑูุฌุฉุ ุฐูุงุก ุงุตุทูุงุนูุ ุชุตููู
   - ุฑุณูุ ููุณูููุ ุชุตููุฑ
   - ุดุนุฑุ ูุตุตุ ููุงูุงุช
   - ูุฑุฉ ูุฏูุ ููุงูุฉุ ุชุบุฐูุฉ
   - ุณูุงุญุฉุ ูุบุงูุฑุงุชุ ุซูุงูุงุช
   - ุฑูุงุฏุฉุ ุชุณูููุ ุฅุฏุงุฑุฉ

### โ **ุงูุญููู ุงููุถุงูุฉ:**
1. **ูู ุฌุฏูู users:**
   - `is_banned` - ูุญุธุฑ ุงููุณุชุฎุฏููู
   - `ban_reason` - ูุชูุถูุญ ุณุจุจ ุงูุญุธุฑ

2. **ูู ุฌุฏูู posts:**
   - `is_private` - ููููุดูุฑุงุช ุงูุฎุงุตุฉ/ุงูุนุงูุฉ
   - `is_featured` - ููููุดูุฑุงุช ุงููููุฒุฉ

3. **ูู ุฌุฏูู notifications:**
   - `title` - ุนููุงู ุงูุฅุดุนุงุฑ
   - `body` - ูุญุชูู ุงูุฅุดุนุงุฑ
   - `data` - ุจูุงูุงุช ุฅุถุงููุฉ (JSON)
   - `type` - ุฅุถุงูุฉ ููุน 'admin'

---

## ๐ ุงููุตุงุฏูุฉ

### **ุชุณุฌูู ุงูุฏุฎูู:**
1. ุงููุณุชุฎุฏู ูุฏุฎู ุฑูู ุงููุงุชู
2. ูุชู ุฅุฑุณุงู OTP ุนุจุฑ WhatsApp
3. ุงููุณุชุฎุฏู ูุฏุฎู OTP
4. ูุชู ุฅูุดุงุก JWT Token

### **ุงูุญูุงูุฉ:**
- ุฌููุน ุงููุณุงุฑุงุช ุงููุญููุฉ ุชุญุชุงุฌ JWT Token
- Token ูุชู ุฅุฑุณุงูู ูู Header: `Authorization: Bearer <token>`

---

## ๐ก API Endpoints

### **Auth:**
- `POST /api/auth/send-otp` - ุฅุฑุณุงู OTP
- `POST /api/auth/verify-otp` - ุงูุชุญูู ูู OTP
- `POST /api/auth/register` - ุงูุชุณุฌูู
- `POST /api/auth/login` - ุชุณุฌูู ุงูุฏุฎูู

### **Boxes & Categories:** โจ **ุฌุฏูุฏ**
- `GET /api/boxes` - ุฌููุน ุงูุตูุงุฏูู ุงููุดุทุฉ
- `GET /api/boxes/:id` - ุตูุฏูู ูุงุญุฏ ูุน ูุฆุงุชู
- `GET /api/boxes/categories` - ุฌููุน ุงููุฆุงุช ุงููุดุทุฉ
- `GET /api/boxes/admin/all` - ุฌููุน ุงูุตูุงุฏูู (Admin)
- `POST /api/boxes/admin` - ุฅูุดุงุก ุตูุฏูู (Admin)
- `PUT /api/boxes/admin/:id` - ุชุญุฏูุซ ุตูุฏูู (Admin)
- `DELETE /api/boxes/admin/:id` - ุญุฐู ุตูุฏูู (Admin)
- `GET /api/boxes/admin/categories/all` - ุฌููุน ุงููุฆุงุช (Admin)
- `POST /api/boxes/admin/categories` - ุฅูุดุงุก ูุฆุฉ (Admin)
- `PUT /api/boxes/admin/categories/:id` - ุชุญุฏูุซ ูุฆุฉ (Admin)
- `DELETE /api/boxes/admin/categories/:id` - ุญุฐู ูุฆุฉ (Admin)

### **Posts:**
- `GET /api/posts` - ุฌููุน ุงูููุดูุฑุงุช ุงูุนุงูุฉ
- `GET /api/posts/my/private` - ุงูููุดูุฑุงุช ุงูุฎุงุตุฉ ูููุณุชุฎุฏู
- `POST /api/posts/:id/publish` - ูุดุฑ ููุดูุฑ ุฎุงุต (ุชุญูููู ูุนุงู) โจ **ุฌุฏูุฏ**
- `GET /api/posts/:id` - ููุดูุฑ ูุงุญุฏ
- `POST /api/posts` - ุฅูุดุงุก ููุดูุฑ
- `PUT /api/posts/:id` - ุชุญุฏูุซ ููุดูุฑ
- `DELETE /api/posts/:id` - ุญุฐู ููุดูุฑ

### **Users:**
- `GET /api/users/profile` - ุงูููู ุงูุดุฎุตู
- `PUT /api/users/profile` - ุชุญุฏูุซ ุงูููู ุงูุดุฎุตู
- `GET /api/users/:id` - ููู ูุณุชุฎุฏู ุขุฎุฑ

### **Comments:**
- `GET /api/comments/:postId` - ุชุนูููุงุช ููุดูุฑ
- `POST /api/comments` - ุฅุถุงูุฉ ุชุนููู
- `DELETE /api/comments/:id` - ุญุฐู ุชุนููู

### **Likes:**
- `POST /api/likes/:postId` - ุฅุถุงูุฉ/ุฅุฒุงูุฉ ุฅุนุฌุงุจ

### **Favorites:**
- `GET /api/favorites` - ุงูููุถูุงุช
- `POST /api/favorites/:postId` - ุฅุถุงูุฉ/ุฅุฒุงูุฉ ูู ุงูููุถูุงุช

### **Admin:** โจ **ุฌุฏูุฏ**
- `GET /api/admin/stats` - ุฅุญุตุงุฆูุงุช Dashboard
- `GET /api/admin/users` - ุฌููุน ุงููุณุชุฎุฏููู
- `PUT /api/admin/users/:id/ban` - ุญุธุฑ ูุณุชุฎุฏู
- `PUT /api/admin/users/:id/unban` - ุฅูุบุงุก ุญุธุฑ ูุณุชุฎุฏู
- `DELETE /api/admin/users/:id` - ุญุฐู ูุณุชุฎุฏู
- `GET /api/admin/posts` - ุฌููุน ุงูููุดูุฑุงุช
- `DELETE /api/admin/posts/:id` - ุญุฐู ููุดูุฑ
- `GET /api/admin/comments` - ุฌููุน ุงูุชุนูููุงุช
- `DELETE /api/admin/comments/:id` - ุญุฐู ุชุนููู
- `POST /api/admin/notifications/send` - ุฅุฑุณุงู ุฅุดุนุงุฑ

---

## ๐ ุงููุดุฑ ุนูู VPS

ุฑุงุฌุน ููู `FINAL_PRODUCTION_STATUS.md` ููุญุตูู ุนูู ุฏููู ูุงูู ูููุดุฑ.

---

## ๐ ุงูุฏุนู

ูููุณุงุนุฏุฉ ุฃู ุงูุงุณุชูุณุงุฑุงุชุ ุฑุงุฌุน ุงูุชูุซูู ุงููุงูู ูู ุงููุดุฑูุน.

---

**ุขุฎุฑ ุชุญุฏูุซ:** 2024  
**ุงูุฅุตุฏุงุฑ:** 1.0.0
